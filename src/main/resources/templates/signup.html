<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"  th:replace="base::layout(~{::section})">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This is Signup Page</title>
</head>
<body >

    <section>
        <div class="container">
            <div class="row">

                <div class="col-md-6 offset-md-3 mt-3">

                    <div class="mycard mt-5">

                        <div th:if="${session.message}" th:classappend="${session.message.type}" class="alert " role="alert">
                        <p class="text-center" th:text="${session.message.content}"></p>
                         <!--   <th:block th:with="${#session.removeAttribute('message')}"></th:block> -->

                        </div>
                        <!-- <div th:if="${session.message}" th:classappend="$(session.message.type)" class="alert " role="alert" >
                            <p th:text="${session.message.content}"></p>
 -->

                            <!-- th:block is used to simply remove the alert after user  -->
                                                   
                      <h2 class="text-center">Register Here !!</h2>

                      <form action="" th:action="@{/do_register}" method="post" th:object="${user}">

                        <!-- nameField -->
                        <div class="mb-2">
                            <label for="name_field" class="form-label ">Name</label>
                            <input 
                            name="name" 
                            class="form-control" 
                            id="name_field" 
                            aria-describedby="emailHelp"
                            placeholder="Enter a valid name"
                            th:value="${user.name}"
                            required>

                           
                            
                        </div>

                        <!-- email Field -->
                        <div class="mb-2 form-row">
                            <div class="col-9">
                                
                            <label for="email_field" class="form-label">Email Address</label>
                            <input 
                            name="email"
                            type="email" 
                            class="form-control" 
                            id="email" 
                            aria-describedby="emailHelp"
                            placeholder="Enter a valid e-mail"
                            th:value="${user.email}"
                            required>
                            </div>
                            <div class="col mt-4"> 
                                <button type="button" onclick="sendMail()" class="btn btn-sm btn-primary mt-2" > Send Mail</button>

                            <script>
                            function sendMail() {
                                const email = document.getElementById("email").value;
                                if (!email) {
                                alert("Please enter an email first.");
                                return;
                                }
                                email.readOnly = true; 
                                window.location.href = "/mail-varification?email=" + encodeURIComponent(email);
                            }
                            </script>

                            </div>
                            
                            
                            
                        </div>

                       
                        <!-- Password Field -->
                        <div class="mb-2">
                            <label for="password_field" class="form-label">Password</label>
                            <input 
                            name="password"
                            type="password" 
                            class="form-control" 
                            id="password_field" 
                            aria-describedby="emailHelp"
                            placeholder="Enter Password Here"
                            required>
                            
                        </div>

                        <div class="form-group">
                            <textarea name="about" th:text="${user.about}" placeholder="Enter About Yourself!!" id="" class="form-control" rows="4"></textarea>

                        </div>
                        <!-- Otp Field -->
                        <div class="mb-2 form-row">
                            <div class="col-2 mt-2 text-center">
                            <label for="Otp_field" class="form-label"> OTP : </label>
                            </div>
                            <div class="col">
                            <input 
                            name="otp"
                            type="number" 
                            class="form-control" 
                            id="otp_field" 
                            aria-describedby="emailHelp"
                            placeholder="Verify OTP sent to Your Mail"
                            required>
                            </div>
                        </div>
                        
                        <!-- terms and condtions agreement -->

                        <div class="form-group form-check text-center mt-2">
                            <input type="checkbox"
                            name="agreement"
                            class="for-check-input"
                            id="agreement">

                            <label for="agreement">Accept terms and conditions.</label>


                        </div>

                        <!-- buttons -->
                        <div class="container text-center">

                            <button type="submit" id="verifyBtn" 
                                    class="btn primary btn-block text-white"
                                    th:attr="disabled=${session.otpSent == null}">
                                Verify OTP
                            </button>
                            <button type="reset" class="btn btn-warning btn-block text-white">
                                Reset
                            </button>
                        </div>

                      </form>
                        
                    </div>


                </div>

            </div>
        </div>
        
    
    </section>
    
</body>
</html>